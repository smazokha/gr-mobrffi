id: mobrffi_get_fingerprint
label: MobRFFI Fingerprint Extractor
category: '[mobrffi]'

parameters:
- id: vectorLength
  label: Input vector length
  dtype: int
  default: 400
- id: embeddingLength
  label: Output embedding length
  dtype: int
  default: 768
- id: specWidth
  label: Spectrogram width (win_len)
  dtype: int
  default: 80
- id: modelPath
  label: ONNX model path
  dtype: file_open
  default: /path/to/model.onnx
- id: computeMode
  label: Compute device
  dtype: enum
  options: ['CPU', 'GPU']
  option_labels: ['CPU', 'GPU']
  default: 'CPU'

inputs:
- domain: stream
  dtype: complex
  vlen: ${vectorLength}

outputs:
- domain: stream
  dtype: float
  vlen: ${embeddingLength}

templates:
  imports: |-
    from gnuradio import mobrffi
  make: |-
    mobrffi.get_fingerprint(
        vectorLength=${vectorLength},
        embeddingLength=${embeddingLength},
        specWidth=${specWidth},
        modelPath=${modelPath},
        computeMode='${computeMode}',
    )


cpp_templates: { }  # python-only

documentation: Ingests a vector containing raw IQ from an OFDM preamble, transforms into a channel-independent spectrogram, and returns an extracted device fingerprint.

file_format: 1
